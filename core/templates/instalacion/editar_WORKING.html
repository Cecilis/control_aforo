{% extends "layouts/base-modal.html" %}

{% block title %}
<ul class="breadcrumbs">
    <li class="nav-home">
        <a href="#">
            <i class="fas fa-map-marked-alt"></i>
        </a>
    </li>
    <li class="separator">
        <i class="flaticon-right-arrow"></i>
    </li>
    <li class="nav-item">
        <a href="#">Instalación</a>
    </li>
    <li class="separator">
        <i class="flaticon-right-arrow"></i>
    </li>
    <li class="nav-item">
        <a href="#">Editar</a>
    </li>
</ul>
{% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block modal-content-title-dissmiss %}
onclick="javascript:window.location='/instalacion/todos'"
{% endblock modal-content-title-dissmiss %}
{% block modal-content-form-tag-begin %}

<form method="POST" class="post-form" action="/instalacion/actualizar/{{instalacion.id_registro.value}}/">
    {% endblock modal-content-form-tag-begin %}
    {% block modal-content-title %} Instalación {% endblock modal-content-title %}
    {% block modal-content %}
    {% csrf_token %}
    <div class="row">
        <div class="col-12">
            <input type="hidden" name="id_registro" id="id_id_registro" value="{{instalacion.id_registro.value}}"/>
            <div class="card">
                <div class="card-body">
                    <div class="form-row m-0 p-2">
                        <div class="form-group col-12 col-xs-5 col-sm-5 col-lg-3">
                            <label class="col-form-label col-form-label-sm">Nombre comercial:</label>
                            <input type="text" name="nombre_comercial" id="id_nombre_comercial"
                                   class="form-control form-control-sm" required maxlength="100"
                                   value="{{ instalacion.nombre_comercial.value }}"/>
                        </div>
                        <div class="form-group col-12 col-xs-12 col-sm-12 col-lg-5">
                            <label class="col-form-label col-form-label-sm">Dirección:</label>
                            <input type="text" name="direccion" id="id_direccion" class="form-control form-control-sm"
                                   required
                                   maxlength="255" value="{{ instalacion.direccion.value }}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-4">
                            <label class="col-form-label col-form-label-sm">Población:</label>
                            <input type="text" name="poblacion" id="id_poblacion" class="form-control form-control-sm"
                                   required
                                   maxlength="100" value="{{instalacion.poblacion.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-4">
                            <label class="col-form-label col-form-label-sm">Provincia:</label>
                            <input type="text" name="provincia" id="id_provincia" class="form-control form-control-sm"
                                   required
                                   maxlength="100" value="{{ instalacion.provincia.value }}"/>
                        </div>
                        <div class="form-group col-12 col-sm-4 col-sm-4 col-lg-4">
                            <label class="col-form-label col-form-label-sm">Código postal:</label>
                            <input type="text" name="codigo_postal" id="id_codigo_postal"
                                   class="form-control form-control-sm" required
                                   maxlength="100" value="{{ instalacion.codigo_postal.value }}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-3">
                            <label class="col-form-label col-form-label-sm">Teléfono:</label>
                            <input type="text" name="telefono" id="id_telefono" class="form-control form-control-sm"
                                   required
                                   maxlength="100" value="{{ instalacion.telefono.value }}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-3">
                            <label class="col-form-label col-form-label-sm">Movil:</label>
                            <input type="text" name="movil" id="id_movil" class="form-control form-control-sm" required
                                   maxlength="100" value="{{ instalacion.movil.value }}"/>
                        </div>
                        <div class="form-group col-12 col-xs-12 col-sm-12 col-lg-6">
                            <label class="col-form-label col-form-label-sm">e-mail:</label>
                            <input type="text" name="email" id="id_email" class="form-control form-control-sm" required
                                   maxlength="100" value="{{ instalacion.email.value }}"/>
                        </div>
                        <div class="form-group col-12">
                            <label class="col-form-label">Contacto:</label>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-4 col-lg-3">
                            <label class="col-form-label">Nombre:</label>
                            <input type="text" name="contacto_nombre" id="id_contacto_nombre" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.contacto_nombre.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-4 col-lg-3">
                            <label class="col-form-label">Cargo :</label>
                            <input type="text" name="contacto_cargo" id="id_contacto_cargo" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.contacto_cargo.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-12 col-sm-6 col-lg-6">
                            <label class="col-form-label">e-mail:</label>
                            <input type="text" name="contacto_email" id="id_contacto_email" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.contacto_email.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-4 col-lg-3">
                            <label class="col-form-label">Teléfono:</label>
                            <input type="text" name="contacto_telefono" id="id_contacto_telefono" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.contacto_telefono.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-4 col-lg-3">
                            <label class="col-form-label">Movil:</label>
                            <input type="text" name="contacto_movil" id="id_contacto_movil" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.contacto_movil.value}}"/>
                        </div>
                        <div class="form-group col-12">
                            <label class="col-form-label">Técnico:</label>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-3">
                            <label class="col-form-label">Nombre:</label>
                            <input type="text" name="tecnico_nombre" id="id_tecnico_nombre" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.tecnico_nombre.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-3">
                            <label class="col-form-label">Cargo :</label>
                            <input type="text" name="tecnico_cargo" id="id_tecnico_cargo" class="form-control" required
                                   maxlength="100" value="{{ instalacion.tecnico_cargo.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-12 col-sm-6 col-lg-6">
                            <label class="col-form-label">e-mail:</label>
                            <input type="text" name="tecnico_email" id="id_tecnico_email" class="form-control" required
                                   maxlength="100" value="{{ instalacion.tecnico_email.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-3">
                            <label class="col-form-label">Teléfono:</label>
                            <input type="text" name="tecnico_telefono" id="id_tecnico_telefono" class="form-control"
                                   required
                                   maxlength="100" value="{{ instalacion.tecnico_telefono.value}}"/>
                        </div>
                        <div class="form-group col-12 col-xs-6 col-sm-6 col-lg-3">
                            <label class="col-form-label">Movil:</label>
                            <input type="text" name="tecnico_movil" id="id_tecnico_movil" class="form-control" required
                                   maxlength="100" value="{{ instalacion.tecnico_movil.value}}"/>
                        </div>
                        <div class="form-group form-inline col-12">
                            <label class="col-form-label mr-3">Estado:</label>
                            <input type="checkbox" name="instalacion_estado" id="id_instalacion_estado" class="form-control"
                                   value="True" {% if instalacion.instalacion_estado.value %}checked{% endif %} />
                        </div>
                        <br>
                        <div class="form-group col-12">
                            {% if instalacion.errors %}
                            <div class="alert alert-danger my-1">
                            {% for field in instalacion.monitores %}
                                {% if field.errors %}
                                    {% for key, value in field.errors.items %}
                                        {{ key }}:{{ value }}
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--div>
    {{ instalacion.monitores.management_form }}
    {% for monitor in instalacion.monitores %}
    <div class="col-12 col-sm-6 col-lg-4">
    <div class="card">
    <div class="card-body bg-light">
    {{ monitor.as_ul }}
    </div>
    </div>
    </div>
    {% endfor %}
    </div-->

    <!------------------------------------ Monitores --------------------------------->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <div class="card-tittle">Monitores</div>
                </div>
                <div class="card-body">
                    <div class="table-responsive w-100">
                        <table class="display table table-striped table-hover monitores-array-model-field">
                            <thead>
                            <tr>
                                <th>Mac WiFi</th>
                                <th>Mac BT</th>
                                <th>Zona</th>
                                <th>Orientación</th>
                                <th>Color barra cabecera</th>
                                <th>Logotipo</th>
                                <th>Logotipo posición</th>
                                <th>Fondo imagen</th>
                                <th>Formato</th>
                                <th>Mostrar máximo</th>
                                <th>Mostrar casi lleno</th>
                                <th>Frase Verde</th>
                                <th>Frase Ambar</th>
                                <th>Frase Rojo</th>
                                <th>Estado</th>
                                <th>Eliminar</th>
                            </tr>
                            </thead>
                            <tbody>

                            {{ instalacion.monitores.management_form }}
                            {% for fm in instalacion.monitores %}
                            <tr>
                                <td>
                                    <input type="text" name="{{ 'monitores-'}}{{forloop.counter0}}{{'-mac_wifi'}}"
                                           maxlength="30"
                                           value=" {{fm.mac_wifi.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-mac_wifi'}}">
                                </td>
                                <td>
                                    <input type="text" name="{{ 'monitores-'}}{{forloop.counter0}}{{'-mac_bluetooth'}}"
                                           maxlength="30"
                                           value=" {{fm.mac_bluetooth.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-mac_bluetooth'}}">
                                </td>
                                <td>
                                    <input type="text" name="{{ 'monitores-'}}{{forloop.counter0}}{{'-id_camara_zona'}}"
                                           maxlength="30"
                                           value=" {{fm.id_camara_zona.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-id_camara_zona'}}">
                                </td>
                                <td>
                                    <input type="text"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-orientacion_display'}}"
                                           maxlength="30"
                                           value=" {{fm.orientacion_display.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-orientacion_display'}}">
                                </td>
                                <td>
                                    <select name="{{ 'monitores-'}}{{forloop.counter0}}{{'-color_barra_cabecera'}}"
                                            id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-color_barra_cabecera'}}">
                                        <option value="WTH" selected>Blanco</option>
                                        <option value="G30">Gris 30</option>
                                        <option value="G60">Gris 60</option>
                                        <option value="BLK">Negro</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" name="{{ 'monitores-'}}{{forloop.counter0}}{{'-logotipo'}}"
                                           maxlength="30"
                                           value=" {{fm.logotipo.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-logotipo'}}"/>
                                </td>
                                <td>
                                    <select name="{{ 'monitores-'}}{{forloop.counter0}}{{'-logotipo_posicion'}}"
                                            id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-logotipo_posicion'}}">
                                        <option value="CTR">Centro</option>
                                        <option value="RGT" selected>Derecha</option>
                                        <option value="LFT">Izquierda</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" name="{{ 'monitores-'}}{{forloop.counter0}}{{'-fondo_imagen'}}"
                                           maxlength="30"
                                           value=" {{fm.fondo_imagen.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-fondo_imagen'}}">
                                </td>
                                <td>
                                    <select name="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_formato'}}"
                                            id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-aforo_formato'}}">
                                        <option value="PCT">Porcentaje</option>
                                        <option value="RGT" selected>Número</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="checkbox"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_mostrar_maximo'}}"
                                           maxlength="30"
                                           value=" {{fm.aforo_mostrar_maximo.value }}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-aforo_mostrar_maximo'}}"/>
                                </td>
                                <td>
                                    <input type="checkbox"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_casi_lleno'}}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-aforo_casi_lleno'}}"
                                           value="{{ fm.aforo_casi_lleno.value }}"/>
                                </td>
                                <td>
                                    <input type="text"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_frase_verde'}}"
                                           id="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_frase_verde'}}"
                                           maxlength="300"
                                           value=" {{fm.aforo_frase_verde.value }}"/>
                                </td>
                                <td>
                                    <input type="text"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_frase_ambar'}}"
                                           id="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_frase_ambar'}}"
                                           maxlength="300"
                                           value=" {{fm.aforo_frase_ambar.value }}"/>
                                </td>
                                <td>
                                    <input type="text"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_frase_rojo'}}"
                                           id="{{ 'monitores-'}}{{forloop.counter0}}{{'-aforo_frase_rojo'}}"
                                           maxlength="300"
                                           value=" {{fm.aforo_frase_rojo.value }}"/>
                                </td>
                                <td>
                                    <input type="checkbox"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-monitor_estado'}}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-monitor_estado'}}"
                                           value="True" {% if fm.monitor_estado.value %}checked{% endif %} />
                                </td>
                                <td>
                                    <input type="checkbox"
                                           name="{{ 'monitores-'}}{{forloop.counter0}}{{'-DELETE'}}"
                                           id="{{ 'id_monitores-'}}{{forloop.counter0}}{{'-DELETE'}}"
                                           value="True" {% if fm.DELETE.value %}checked{% endif %}/>
                                </td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <!--------------------------------Errores en Monitores ------------------------------->
                    <div class="form-group col-12 p-0">
                        {% if instalacion.monitores.errors %}
                        <div class="alert alert-danger m-0 p-0 ml-3">
                            {% for monitor in instalacion.monitores %}
                                {% if monitor.errors %}
                                    {% for key, value in monitor.errors.items %}
                                        {{ key }}:{{ value }}
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-----------------------  Flags Control de Formset  ----------------------------->

    <input type="hidden" name="monitores-TOTAL_FORMS" value="{{ instalacion.monitores|length }}" id="id_monitores-TOTAL_FORMS">
    <input type="hidden" name="monitores-INITIAL_FORMS" value="1" id="id_monitores-INITIAL_FORMS">
    <input type="hidden" name="monitores-MIN_NUM_FORMS" value="0" id="id_monitores-MIN_NUM_FORMS">
    <input type="hidden" name="monitores-MAX_NUM_FORMS" value="1000" id="id_monitores-MAX_NUM_FORMS">
    <!------------------------------------------------------------------------------->

    <!------------------------------------------------------------------------------->
    <div class="form-group bg-prmary col-12">
        {% if instalacion.errors %}
        {% for error in instalacion.non_field_errors %}
        <div class="alert alert-danger">
            * {{field.name}} <strong>{{ error|escape }}</strong>
            <br>
        </div>
        {% endfor %}
        {% endif %}
    </div>
    {% endblock modal-content %}
    {% block modal-content-footer %}
    <button type="submit" class="btn btn-success">Guardar</button>
    <button type="reset" class="btn btn-warning" data-dismiss="modal">Cancelar</button>
    <button type="button" class="btn btn-danger" data-dismiss="modal"
            onclick="javascript:window.location='/instalacion/todos'">Cerrar
    </button>
    {% endblock modal-content-footer %}
    {% block modal-content-form-tag-end %}
</form>
{% endblock modal-content-form-tag-end %}
<!-- Specific JS goes HERE -->
{% block javascripts %}{% endblock javascripts %}